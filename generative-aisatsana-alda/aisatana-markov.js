var Chain = require('markov-chains').default;
var fs = require('fs');

/**
 * returns a markov-chain generated sequence of 'aisatsana', based off the original aisatsana phrases
 * converted to Alda compatible REPL strings from the MIDI sequence of aisatsana by Aphex Twin.
 * @return {Object} Object containing array of Alda compatible strings + stats
 */
function generate() {
    let aisatsanaAldaPhrases = [
        ["o3 (volume 30.71) e 0.5882355s", "o3 (volume 31.50) g 0.5882355s", "o3 (volume 29.92) c 0.5882354999999999s", "o4 (volume 33.86) c 7.6470615s"],
        ["o3 (volume 30.71) e 0.5882354999999997s", "o3 (volume 31.50) g 0.5882354999999997s", "o3 (volume 29.92) c 0.5882354999999997s", "o4 (volume 33.86) c 0.5882354999999997s", "o3 (volume 32.28) b 2.3529420000000005s", "o4 (volume 15.75) e 4.705884000000001s"],
        ["o3 (volume 30.71) e 0.5882354999999997s", "o3 (volume 31.50) g 0.5882354999999997s", "o3 (volume 29.92) c 0.5882354999999997s", "o4 (volume 33.86) c 0.5882354999999997s", "o3 (volume 32.28) b 7.058826s"],
        ["o3 (volume 31.50) g 0.5882354999999997s", "o3 (volume 29.92) c 0.5882354999999997s", "o4 (volume 33.86) c 0.5882354999999997s", "o3 (volume 32.28) b 1.1764709999999994s", "o4 (volume 31.50) e 5.882354999999997s"],
        ["o4 (volume 30.71) e 0.29411774999999807s / o3 (volume 30.71) e 0.29411774999999807s", "o4 (volume 30.71) e 0.5882355000000032s / o3 (volume 31.50) g 0.5882355000000032s", "o4 (volume 30.71) d 0.5882355000000032s / o3 (volume 29.92) c 0.5882355000000032s", "o4 (volume 29.92) c 7.6470614999999995s / o3 (volume 31.50) e 7.6470614999999995s"],
        ["o4 (volume 30.71) e 0.29411774999999807s / o3 (volume 30.71) g 0.29411774999999807s", "o4 (volume 30.71) e 0.5882355000000032s / o3 (volume 30.71) e 0.5882355000000032s", "o4 (volume 30.71) d 0.5882355000000032s / o3 (volume 29.92) c 0.5882355000000032s", "o4 (volume 29.92) c 0.5882355000000032s / o3 (volume 31.50) e 7.6470614999999995s", "o3 (volume 29.92) b 2.3529419999999988s", "o4 (volume 15.75) e 4.7058839999999975s"],
        ["o4 (volume 30.71) e 0.29411774999999807s / o4 (volume 30.71) c 0.29411774999999807s", "o4 (volume 30.71) e 0.5882355000000032s / o3 (volume 29.92) e 0.5882355000000032s", "o4 (volume 30.71) d 0.5882355000000032s / o3 (volume 29.92) c 0.5882355000000032s", "o4 (volume 29.92) c 0.5882355000000032s / o3 (volume 31.50) e 0.5882355000000032s", "o3 (volume 29.92) b 7.058826000000003s / o3 (volume 30.71) d 7.058826000000003s"], //7
        ["o4 (volume 30.71) e 0.29411774999999807s / o3 (volume 30.71) e 0.29411774999999807s", "o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o4 (volume 29.92) c 0.5882354999999961s / o3 (volume 31.50) e 7.647061499999992s", "o3 (volume 29.92) b 2.3529419999999988s", "o4 (volume 15.75) e 4.7058839999999975s"],
        ["o4 (volume 30.71) e 0.29411774999999807s / o3 (volume 30.71) e 0.29411774999999807s", "o4 (volume 59.84) g 0.29411774999999807s", "o4 (volume 60.63) a 0.29411774999999807s / o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 62.20) b 0.29411774999999807s", "o5 (volume 62.99) c 0.5882354999999961s / o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o5 (volume 65.35) e 7.647061500000007s / o4 (volume 29.92) c 7.647061500000007s / o3 (volume 31.50) e 7.647061500000007s"],
        ["o4 (volume 30.71) e 0.29411774999999807s / o3 (volume 30.71) e 0.29411774999999807s", "o4 (volume 59.84) g 0.29411774999999807s", "o4 (volume 60.63) a 0.29411774999999807s / o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 62.20) b 0.29411774999999807s", "o5 (volume 62.99) c 0.5882354999999961s / o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o5 (volume 65.35) e 0.5882354999999961s / o4 (volume 29.92) c 0.5882354999999961s / o3 (volume 31.50) e 7.647061499999992s", "o5 (volume 66.93) b 0.5882354999999961s / o3 (volume 29.92) b 2.3529419999999988s", "o5 (volume 60.63) g 6.4705905s", "o4 (volume 15.75) e 4.7058839999999975s"],
        ["o4 (volume 30.71) e 0.29411774999999807s / o3 (volume 30.71) e 0.29411774999999807s", "o4 (volume 59.84) g 0.29411774999999807s", "o4 (volume 60.63) a 0.29411774999999807s / o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 62.20) b 0.29411774999999807s", "o5 (volume 62.99) c 0.5882354999999961s / o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o5 (volume 65.35) e 7.647061499999992s / o4 (volume 29.92) c 0.5882354999999961s / o3 (volume 31.50) e 7.647061499999992s", "o3 (volume 29.92) b 7.058825999999996s"],
        ["o4 (volume 30.71) e 0.29411774999999807s / o3 (volume 30.71) e 0.29411774999999807s", "o4 (volume 59.84) g 0.29411774999999807s", "o4 (volume 60.63) a 0.29411774999999807s / o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 62.20) b 0.29411774999999807s", "o5 (volume 62.99) c 0.5882354999999961s / o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o5 (volume 65.35) e 0.5882354999999961s / o4 (volume 29.92) c 0.5882354999999961s / o3 (volume 31.50) e 7.647061499999992s", "o5 (volume 66.93) b 0.5882354999999961s / o3 (volume 29.92) b 1.7647065000000026s", "o5 (volume 60.63) g 6.4705905s o4 (volume 31.50) e 5.294119499999994s"], // 12
        ["o4 (volume 30.71) e 0.29411774999999807s / o3 (volume 30.71) e 0.29411774999999807s", "o4 (volume 59.84) g 0.29411774999999807s", "o4 (volume 60.63) a 0.29411774999999807s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 62.20) b 0.29411774999999807s", "o5 (volume 62.99) c 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o5 (volume 65.35) e 7.647061500000007s / o4 (volume 33.86) c 7.647061500000007s"],
        ["o3 (volume 30.71) c 0.5882354999999961s", "o4 (volume 59.84) g 0.29411774999999807s", "o4 (volume 61.42) b 0.29411774999999807s / o3 (volume 32.28) g 0.5882354999999961s", "o4 (volume 59.84) a 0.29411774999999807s", "o5 (volume 62.99) c 0.5882354999999961s / o3 (volume 30.71) e 0.5882354999999961s", "o5 (volume 65.35) e 0.5882354999999961s / o4 (volume 33.86) c 2.941177499999995s", "o5 (volume 66.93) b 0.5882354999999961s", "o5 (volume 60.63) g 6.4705905000000286s", "o4 (volume 30.71) d 4.705884000000026s"],
        ["o3 (volume 30.71) e 0.5882354999999961s", "o4 (volume 30.71) g 0.29411774999999807s", "o4 (volume 31.50) a 0.29411774999999807s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 32.28) b 0.29411774999999807s", "o5 (volume 32.28) c 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o5 (volume 33.86) e 7.647061500000007s / o4 (volume 33.86) c 0.5882354999999961s", "o3 (volume 32.28) b 7.0588260000000105s"],
        ["o3 (volume 30.71) e 0.5882354999999961s", "o4 (volume 30.71) g 0.29411774999999807s", "o4 (volume 31.50) a 0.29411774999999807s / o3 (volume 31.50) g 0.5882354999999961s", "o5 (volume 32.28) c 0.29411774999999807s", "o4 (volume 31.50) b 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o5 (volume 33.86) e 0.5882354999999961s / o4 (volume 33.86) c 0.5882354999999961s", "o5 (volume 34.65) b 0.5882354999999961s / o3 (volume 32.28) b 1.1764709999999923s", "o5 (volume 31.50) g 6.470590500000014s", "o4 (volume 31.50) e 5.882355000000018s"], //16
        ["o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 30.71) e 0.5882354999999961s", "o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o4 (volume 29.92) c 7.647061500000007s / o3 (volume 31.50) e 7.647061500000007s"],
        ["o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 30.71) e 0.5882354999999961s", "o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o4 (volume 29.92) c 0.5882354999999961s / o3 (volume 32.28) g 0.5882354999999961s", "o3 (volume 29.92) b 2.352942000000013s / o3 (volume 30.71) e 7.058826000000039s", "o4 (volume 15.75) e 4.705884000000026s"],
        ["o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 30.71) e 0.5882354999999961s", "o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o4 (volume 29.92) c 0.5882354999999961s / o3 (volume 31.50) e 0.5882354999999961s", "o3 (volume 29.92) b 7.0588260000000105s / o3 (volume 30.71) d 7.0588260000000105s"],
        ["o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 30.71) e 0.5882354999999961s", "o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o4 (volume 29.92) c 0.5882354999999961s / o3 (volume 31.50) e 0.5882354999999961s", "o3 (volume 29.92) b 7.058826000000039s / o2 (volume 29.92) b 2.352942000000013s", "o2 (volume 30.71) a 4.705884000000026s"],
        ["o5 (volume 59.84) c 0.29411774999999807s / o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 30.71) e 0.5882354999999961s", "o4 (volume 59.84) b 0.29411774999999807s", "o4 (volume 58.27) a 0.29411774999999807s / o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 56.69) g 0.29411774999999807s", "o5 (volume 66.93) e 0.5882354999999961s / o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o5 (volume 66.93) g 0.5882354999999961s / o4 (volume 29.92) c 7.647061500000007s / o3 (volume 31.50) e 7.647061500000007s", "o5 (volume 61.42) e 7.0588260000000105s"], //21
        ["o5 (volume 59.84) c 0.29411774999999807s / o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 30.71) e 0.5882354999999961s", "o4 (volume 59.84) b 0.29411774999999807s", "o4 (volume 58.27) a 0.29411774999999807s / o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 56.69) g 0.29411774999999807s", "o5 (volume 69.29) g 0.5882354999999961s / o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o5 (volume 66.93) a 0.5882354999999961s / o4 (volume 29.92) c 0.5882354999999961s / o3 (volume 31.50) e 7.647061500000035s", "o5 (volume 59.84) e 7.058826000000039s / o3 (volume 29.92) b 2.352942000000013s", "o4 (volume 15.75) e 4.705884000000026s"],
        ["o5 (volume 59.84) c 0.29411774999999807s / o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 30.71) e 0.5882354999999961s", "o4 (volume 59.84) b 0.29411774999999807s", "o4 (volume 58.27) a 0.29411774999999807s / o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 56.69) g 0.29411774999999807s", "o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o6 (volume 66.93) c 0.5882354999999961s / o4 (volume 29.92) c 0.5882354999999961s / o3 (volume 31.50) e 7.647061500000007s", "o5 (volume 61.42) g 7.0588260000000105s / o3 (volume 29.92) b 7.0588260000000105s"],
        ["o5 (volume 59.84) c 0.29411774999999807s / o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 30.71) e 0.5882354999999961s", "o4 (volume 59.84) b 0.29411774999999807s", "o4 (volume 58.27) a 0.29411774999999807s / o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 56.69) g 0.29411774999999807s", "o6 (volume 69.29) d 0.5882354999999961s / o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o6 (volume 67.72) g 0.5882354999999961s / o4 (volume 29.92) c 0.5882354999999961s / o3 (volume 31.50) e 7.647061500000007s", "o6 (volume 60.63) c 7.0588260000000105s / o3 (volume 29.92) b 7.0588260000000105s"],
        ["o3 (volume 30.71) e 0.5882354999999961s", "o3 (volume 31.50) g 0.5882354999999961s", "o3 (volume 29.92) c 0.5882354999999961s", "o4 (volume 33.86) c 7.647061500000007s"],
        ["o3 (volume 30.71) e 0.5882354999999961s", "o3 (volume 31.50) g 0.5882354999999961s", "o3 (volume 29.92) c 0.5882354999999961s", "o4 (volume 33.86) c 0.5882354999999961s", "o3 (volume 32.28) b 0.5882354999999961s", "o3 (volume 30.71) a 0.5882354999999961s", "o3 (volume 29.13) e 0.5882354999999961s", "o3 (volume 29.92) d 0.5882354999999961s", "o3 (volume 29.92) c 0.5882354999999961s", "o3 (volume 31.50) d 4.117648500000001s"],
        ["o3 (volume 30.71) e 0.5882354999999961s", "o3 (volume 31.50) g 0.5882354999999961s", "o3 (volume 29.92) c 0.5882354999999961s", "o4 (volume 33.86) c 7.647061500000007s"],
        ["o3 (volume 30.71) e 0.5882354999999961s", "o3 (volume 31.50) g 0.5882354999999961s", "o3 (volume 29.92) c 0.5882354999999961s", "o3 (volume 33.86) b 0.5882354999999961s", "o4 (volume 33.07) c 0.5882354999999961s", "o4 (volume 33.07) e 0.5882354999999961s", "o4 (volume 31.50) d 5.882355000000018s"],
        ["o4 (volume 30.71) e 0.29411774999999807s / o3 (volume 30.71) e 0.29411774999999807s", "o4 (volume 59.84) g 0.29411774999999807s", "o4 (volume 60.63) a 0.29411774999999807s / o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 62.20) b 0.29411774999999807s", "o5 (volume 62.99) c 0.5882354999999961s / o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o5 (volume 65.35) e 7.647061500000007s / o4 (volume 29.92) c 7.647061500000007s / o3 (volume 31.50) e 7.647061500000007s"], //29
        ["o4 (volume 30.71) e 0.29411774999999807s / o3 (volume 30.71) e 0.29411774999999807s", "o4 (volume 59.84) g 0.29411774999999807s", "o4 (volume 60.63) a 0.29411774999999807s / o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 62.20) b 0.29411774999999807s", "o5 (volume 62.99) c 0.5882354999999961s / o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o5 (volume 65.35) e 0.5882354999999961s / o4 (volume 29.92) c 0.5882354999999961s / o3 (volume 31.50) e 7.647061500000007s", "o5 (volume 66.93) b 0.5882354999999961s / o3 (volume 29.92) b 7.0588260000000105s", "o5 (volume 60.63) g 6.470590500000014s"],
        ["o4 (volume 30.71) e 0.29411774999999807s / o3 (volume 30.71) e 0.29411774999999807s", "o4 (volume 59.84) g 0.29411774999999807s", "o4 (volume 60.63) a 0.29411774999999807s / o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 62.20) b 0.29411774999999807s", "o5 (volume 62.99) c 0.5882354999999961s / o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o5 (volume 65.35) e 7.647061500000007s / o4 (volume 29.92) c 0.5882354999999961s / o3 (volume 31.50) e 7.647061500000007s", "o3 (volume 29.92) b 7.0588260000000105s"],
        ["o4 (volume 30.71) e 0.29411774999999807s / o3 (volume 30.71) e 0.29411774999999807s", "o4 (volume 59.84) g 0.29411774999999807s", "o4 (volume 60.63) a 0.29411774999999807s / o4 (volume 30.71) e 0.5882354999999961s / o3 (volume 31.50) g 0.5882354999999961s", "o4 (volume 62.20) b 0.29411774999999807s", "o5 (volume 62.99) c 0.5882354999999961s / o4 (volume 30.71) d 0.5882354999999961s / o3 (volume 29.92) c 0.5882354999999961s", "o5 (volume 65.35) e 0.5882354999999961s / o4 (volume 29.92) c 0.5882354999999961s / o3 (volume 31.50) e 2.3529419999999845s", "o5 (volume 66.93) b 0.5882354999999961s / o3 (volume 29.92) b 1.7647064999999884s", "o5 (volume 60.63) g 8.823532499999999s", "o4 (volume 30.71) e 7.0588260000000105s / o2 (volume 30.71) c 7.0588260000000105s / o3 (volume 30.71) e 7.0588260000000105s"] //32
    ]
    
    const aisatsanaChain = new Chain(aisatsanaAldaPhrases);
    const generatedPhrases = []
    for (let index = 0; index < 32; index++) {
        const walked = aisatsanaChain.walk();
        generatedPhrases.push(walked)
    }
    
    let flattenedAldaInstruments = generatedPhrases.map(phrase => { return phrase.join(" ")});
    const uniquePhrases = [...new Set(flattenedAldaInstruments)];

    return {
        phraseCount: flattenedAldaInstruments.length,
        phrases: flattenedAldaInstruments,
        uniquePhrases: uniquePhrases,
        uniqueTotal: uniquePhrases.length
    };
}

module.exports.generate = generate;